{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 5, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/lionv/DuckSAT/Migration/DuckSAT_CLEAN/src/data/moduleConfigs.ts"],"sourcesContent":["import { ModuleConfig } from '@/types/test'\r\n\r\nexport const MODULE_CONFIGS: ModuleConfig[] = [\r\n  {\r\n    id: 1,\r\n    type: 'reading-writing',\r\n    duration: 32, // 32 minutes\r\n    questionCount: 27, // 27 questions\r\n    title: 'Reading and Writing - Module 1',\r\n    description: 'This module tests your reading comprehension, grammar, and writing skills. You have 32 minutes to complete 27 questions.',\r\n    icon: 'üìö',\r\n    color: 'from-blue-500 to-indigo-600'\r\n  },\r\n  {\r\n    id: 2,\r\n    type: 'reading-writing',\r\n    duration: 32, // 32 minutes\r\n    questionCount: 27, // 27 questions\r\n    title: 'Reading and Writing - Module 2',\r\n    description: 'This module adapts to your Module 1 performance with appropriate difficulty questions. You have 32 minutes to complete 27 questions.',\r\n    icon: 'üìñ',\r\n    color: 'from-indigo-500 to-purple-600'\r\n  },\r\n  {\r\n    id: 3,\r\n    type: 'math',\r\n    duration: 35, // 35 minutes\r\n    questionCount: 22, // 22 questions\r\n    title: 'Math - Module 1',\r\n    description: 'This module covers algebra, geometry, statistics, and advanced math topics. You have 35 minutes to complete 22 questions.',\r\n    icon: 'üî¢',\r\n    color: 'from-green-500 to-emerald-600'\r\n  },\r\n  {\r\n    id: 4,\r\n    type: 'math',\r\n    duration: 35, // 35 minutes\r\n    questionCount: 22, // 22 questions\r\n    title: 'Math - Module 2',\r\n    description: 'This module adapts to your Module 3 performance with appropriate difficulty questions. You have 35 minutes to complete 22 questions.',\r\n    icon: 'üßÆ',\r\n    color: 'from-emerald-500 to-teal-600'\r\n  }\r\n]\r\n\r\nexport const getModuleConfig = (moduleId: number): ModuleConfig | undefined => {\r\n  return MODULE_CONFIGS.find(config => config.id === moduleId)\r\n}\r\n\r\nexport const getTotalTestTime = (): number => {\r\n  return MODULE_CONFIGS.reduce((total, config) => total + config.duration, 0)\r\n}\r\n\r\nexport const getTotalQuestions = (): number => {\r\n  return MODULE_CONFIGS.reduce((total, config) => total + config.questionCount, 0)\r\n}\r\n\r\nexport const getModulesByType = (type: 'reading-writing' | 'math'): ModuleConfig[] => {\r\n  return MODULE_CONFIGS.filter(config => config.type === type)\r\n}\r\n\r\nexport const getReadingWritingModules = (): ModuleConfig[] => {\r\n  return getModulesByType('reading-writing')\r\n}\r\n\r\nexport const getMathModules = (): ModuleConfig[] => {\r\n  return getModulesByType('math')\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;AAEO,MAAM,iBAAiC;IAC5C;QACE,IAAI;QACJ,MAAM;QACN,UAAU;QACV,eAAe;QACf,OAAO;QACP,aAAa;QACb,MAAM;QACN,OAAO;IACT;IACA;QACE,IAAI;QACJ,MAAM;QACN,UAAU;QACV,eAAe;QACf,OAAO;QACP,aAAa;QACb,MAAM;QACN,OAAO;IACT;IACA;QACE,IAAI;QACJ,MAAM;QACN,UAAU;QACV,eAAe;QACf,OAAO;QACP,aAAa;QACb,MAAM;QACN,OAAO;IACT;IACA;QACE,IAAI;QACJ,MAAM;QACN,UAAU;QACV,eAAe;QACf,OAAO;QACP,aAAa;QACb,MAAM;QACN,OAAO;IACT;CACD;AAEM,MAAM,kBAAkB,CAAC;IAC9B,OAAO,eAAe,IAAI,CAAC,CAAA,SAAU,OAAO,EAAE,KAAK;AACrD;AAEO,MAAM,mBAAmB;IAC9B,OAAO,eAAe,MAAM,CAAC,CAAC,OAAO,SAAW,QAAQ,OAAO,QAAQ,EAAE;AAC3E;AAEO,MAAM,oBAAoB;IAC/B,OAAO,eAAe,MAAM,CAAC,CAAC,OAAO,SAAW,QAAQ,OAAO,aAAa,EAAE;AAChF;AAEO,MAAM,mBAAmB,CAAC;IAC/B,OAAO,eAAe,MAAM,CAAC,CAAA,SAAU,OAAO,IAAI,KAAK;AACzD;AAEO,MAAM,2BAA2B;IACtC,OAAO,iBAAiB;AAC1B;AAEO,MAAM,iBAAiB;IAC5B,OAAO,iBAAiB;AAC1B","debugId":null}},
    {"offset": {"line": 78, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/lionv/DuckSAT/Migration/DuckSAT_CLEAN/src/hooks/useTestState.ts"],"sourcesContent":["import { useState, useEffect, useCallback, useMemo } from 'react'\r\nimport { TestState, TestResult, QuestionResult, Question } from '@/types/test'\r\nimport { MODULE_CONFIGS } from '@/data/moduleConfigs'\r\n\r\nexport function useTestState(userId: string) {\r\n  const [testState] = useState<TestState | null>(null)\r\n  const [isLoading, setIsLoading] = useState(true)\r\n  const [error] = useState<string | null>(null)\r\n  const [hasStarted, setHasStarted] = useState(false)\r\n  const [currentModuleIndex, setCurrentModuleIndex] = useState(0)\r\n  const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0)\r\n  const [isTransitioning, setIsTransitioning] = useState(false)\r\n  const [isComplete, setIsComplete] = useState(false)\r\n  const [moduleStarted, setModuleStarted] = useState(false)\r\n  const [isBreakTime, setIsBreakTime] = useState(false)\r\n  const [breakTimeRemaining, setBreakTimeRemaining] = useState(0)\r\n  \r\n  // Timer and answer state\r\n  const [timeRemaining, setTimeRemaining] = useState(0)\r\n  const [selectedAnswers, setSelectedAnswers] = useState<number[]>([])\r\n  const [moduleStartTime, setModuleStartTime] = useState<Date | null>(null)\r\n  const [testStartTime, setTestStartTime] = useState<Date | null>(null)\r\n  \r\n  // Test results tracking\r\n  const [testResults, setTestResults] = useState<TestResult | null>(null)\r\n  const [moduleResults, setModuleResults] = useState<QuestionResult[][]>([])\r\n  \r\n  // Questions from database with no-repeat tracking\r\n  const [currentModuleQuestions, setCurrentModuleQuestions] = useState<Question[]>([])\r\n  const [usedQuestionIds, setUsedQuestionIds] = useState<string[]>([])\r\n  \r\n  // Per-question time tracking\r\n  const [questionStartTimes, setQuestionStartTimes] = useState<Map<number, Date>>(new Map())\r\n  const [questionTimeSpent, setQuestionTimeSpent] = useState<Map<number, number>>(new Map())\r\n\r\n  // Get current module config\r\n  const currentModule = useMemo(() => {\r\n    if (currentModuleIndex >= MODULE_CONFIGS.length) return null\r\n    return MODULE_CONFIGS[currentModuleIndex]\r\n  }, [currentModuleIndex])\r\n\r\n  // Get current question\r\n  const currentQuestion = useMemo(() => {\r\n    if (!currentModule || currentModuleQuestions.length === 0) return null\r\n    \r\n    if (currentQuestionIndex >= currentModuleQuestions.length) return null\r\n    return currentModuleQuestions[currentQuestionIndex]\r\n  }, [currentModule, currentModuleQuestions, currentQuestionIndex])\r\n\r\n  // Fetch questions from database with no-repeat logic\r\n  const fetchQuestions = useCallback(async (moduleType: string, questionCount?: number) => {\r\n    try {\r\n      setIsLoading(true)\r\n      const limit = questionCount || (moduleType === 'math' ? 22 : 27)\r\n      console.log(`üîç Fetching ${limit} questions for moduleType: ${moduleType}`)\r\n      \r\n      // Get more questions than needed to filter out used ones\r\n      const response = await fetch(`/api/questions?moduleType=${moduleType}&limit=${limit * 2}`)\r\n      \r\n      if (!response.ok) {\r\n        throw new Error(`Failed to fetch questions: ${response.statusText}`)\r\n      }\r\n\r\n      const data = await response.json()\r\n      const questions = data.questions || data // Handle both {questions: [...]} and [...] formats\r\n      console.log(`üìù Received ${questions.length || 0} questions from API`)\r\n      \r\n      if (!questions || questions.length === 0) {\r\n        console.warn('‚ö†Ô∏è No questions available from API, returning empty array')\r\n        setCurrentModuleQuestions([])\r\n        setSelectedAnswers([])\r\n        setIsLoading(false)\r\n        return []\r\n      }\r\n\r\n      // Filter out already used questions\r\n      const availableQuestions = questions.filter((q: Question) => !usedQuestionIds.includes(q.id))\r\n      \r\n      // If we don't have enough unused questions, reset the used set (allow repeats but minimize them)\r\n      let questionsToUse = availableQuestions\r\n      if (availableQuestions.length < limit) {\r\n        console.log('‚ö†Ô∏è Not enough unused questions, allowing some repeats')\r\n        questionsToUse = questions\r\n        setUsedQuestionIds([]) // Reset used questions to allow repeats\r\n      }\r\n\r\n      // Select the required number of questions\r\n      const selectedQuestions = questionsToUse.slice(0, limit)\r\n      \r\n      // Add selected question IDs to used set\r\n      const newUsedIds = [...usedQuestionIds]\r\n      selectedQuestions.forEach((q: Question) => {\r\n        if (!newUsedIds.includes(q.id)) newUsedIds.push(q.id)\r\n      })\r\n      setUsedQuestionIds(newUsedIds)\r\n      \r\n      setCurrentModuleQuestions(selectedQuestions)\r\n      setSelectedAnswers(new Array(selectedQuestions.length).fill(-1))\r\n      \r\n      console.log(`‚úÖ Set ${selectedQuestions.length} questions for current module`)\r\n      \r\n    } catch (error) {\r\n      console.error('‚ùå Error fetching questions:', error)\r\n      throw error\r\n    } finally {\r\n      setIsLoading(false)\r\n    }\r\n  }, [usedQuestionIds])\r\n\r\n  // Auto-start module 2 after 10 seconds\r\n  useEffect(() => {\r\n    if (isTransitioning && currentModuleIndex === 1 && !moduleStarted) {\r\n      const timer = setTimeout(() => {\r\n        startModule()\r\n      }, 10000) // 10 seconds\r\n\r\n      return () => clearTimeout(timer)\r\n    }\r\n  }, [isTransitioning, currentModuleIndex, moduleStarted])\r\n\r\n  // Auto-start math module after 10 seconds\r\n  useEffect(() => {\r\n    if (isTransitioning && currentModuleIndex === 2 && !moduleStarted) {\r\n      const timer = setTimeout(() => {\r\n        startModule()\r\n      }, 10000) // 10 seconds\r\n\r\n      return () => clearTimeout(timer)\r\n    }\r\n  }, [isTransitioning, currentModuleIndex, moduleStarted])\r\n\r\n  // Start timing when a new question is displayed\r\n  useEffect(() => {\r\n    if (moduleStarted && !isTransitioning && currentQuestion) {\r\n      setQuestionStartTimes(prev => {\r\n        const newTimes = new Map(prev)\r\n        if (!newTimes.has(currentQuestionIndex)) {\r\n          newTimes.set(currentQuestionIndex, new Date())\r\n        }\r\n        return newTimes\r\n      })\r\n    }\r\n  }, [moduleStarted, isTransitioning, currentQuestion, currentQuestionIndex])\r\n\r\n  // Handle 10-minute break between reading and math\r\n  useEffect(() => {\r\n    if (isBreakTime && breakTimeRemaining > 0) {\r\n      const timer = setTimeout(() => {\r\n        setBreakTimeRemaining(prev => prev - 1)\r\n      }, 1000)\r\n\r\n      return () => clearTimeout(timer)\r\n    } else if (isBreakTime && breakTimeRemaining === 0) {\r\n      // Break is over, start math module\r\n      setIsBreakTime(false)\r\n      setIsTransitioning(true)\r\n      setCurrentModuleIndex(2) // Math module\r\n    }\r\n  }, [isBreakTime, breakTimeRemaining])\r\n\r\n  const startTest = useCallback(async () => {\r\n    try {\r\n      setIsLoading(true)\r\n      setTestStartTime(new Date())\r\n      setHasStarted(true)\r\n      setCurrentModuleIndex(0)\r\n      setCurrentQuestionIndex(0)\r\n\r\n      // Start with reading-writing module\r\n      await fetchQuestions('reading-writing', 27)\r\n\r\n      setIsTransitioning(false)\r\n      setModuleStarted(false)\r\n    } catch (error) {\r\n      console.error('Error starting test:', error)\r\n      setIsLoading(false)\r\n    }\r\n  }, [fetchQuestions])\r\n\r\n  const startModule = useCallback(() => {\r\n    if (!currentModule) return\r\n\r\n    console.log('üöÄ Starting module:', currentModule.title)\r\n\r\n    setModuleStartTime(new Date())\r\n    setModuleStarted(true)\r\n    setIsTransitioning(false)\r\n    setCurrentQuestionIndex(0)\r\n\r\n    // Set timer for current module (convert minutes to seconds)\r\n    setTimeRemaining(currentModule.duration * 60)\r\n    \r\n    // Reset time tracking for new module\r\n    setQuestionStartTimes(new Map())\r\n    setQuestionTimeSpent(new Map())\r\n\r\n    console.log('‚úÖ Module started successfully')\r\n  }, [currentModule])\r\n\r\n  // Track time spent on current question before navigating away\r\n  const recordQuestionTime = useCallback(() => {\r\n    const startTime = questionStartTimes.get(currentQuestionIndex)\r\n    if (startTime) {\r\n      const now = new Date()\r\n      const timeSpent = Math.floor((now.getTime() - startTime.getTime()) / 1000)\r\n      const existingTime = questionTimeSpent.get(currentQuestionIndex) || 0\r\n      const newTimeSpent = new Map(questionTimeSpent)\r\n      newTimeSpent.set(currentQuestionIndex, existingTime + timeSpent)\r\n      setQuestionTimeSpent(newTimeSpent)\r\n    }\r\n  }, [currentQuestionIndex, questionStartTimes, questionTimeSpent])\r\n\r\n  const completeModule = useCallback(async () => {\r\n    if (!currentModule || !moduleStartTime) return\r\n\r\n    const endTime = new Date()\r\n    \r\n    // Record time for current question before completing\r\n    recordQuestionTime()\r\n    \r\n    // Calculate module results with actual time per question\r\n    const moduleQuestionResults: QuestionResult[] = currentModuleQuestions.map((question, index) => ({\r\n      questionId: question.id,\r\n      question: question.question,\r\n      category: question.category,\r\n      difficulty: question.difficulty,\r\n      moduleType: question.moduleType,\r\n      userAnswer: selectedAnswers[index] || -1,\r\n      correctAnswer: question.correctAnswer,\r\n      isCorrect: selectedAnswers[index] === question.correctAnswer,\r\n      timeSpent: questionTimeSpent.get(index) || 0, // Use actual tracked time\r\n      options: question.options,\r\n      explanation: question.explanation\r\n    }))\r\n\r\n    // Add to module results\r\n    const newModuleResults = [...moduleResults]\r\n    newModuleResults[currentModuleIndex] = moduleQuestionResults\r\n    setModuleResults(newModuleResults)\r\n\r\n    // Check if this is the end of reading modules (before math)\r\n    if (currentModuleIndex === 1) {\r\n      // Start 10-minute break\r\n      setIsBreakTime(true)\r\n      setBreakTimeRemaining(600) // 10 minutes = 600 seconds\r\n      setModuleStarted(false)\r\n      return\r\n    }\r\n\r\n    // Move to next module or complete test\r\n    if (currentModuleIndex < MODULE_CONFIGS.length - 1) {\r\n      setCurrentModuleIndex(prev => prev + 1)\r\n      setIsTransitioning(true)\r\n      setModuleStarted(false)\r\n      setCurrentModuleQuestions([]) // Clear questions for next module\r\n      \r\n      // Fetch questions for next module\r\n      const nextModule = MODULE_CONFIGS[currentModuleIndex + 1]\r\n      if (nextModule) {\r\n        await fetchQuestions(nextModule.type, nextModule.questionCount)\r\n      }\r\n    } else {\r\n      // Test complete\r\n      completeTest(newModuleResults)\r\n    }\r\n  }, [currentModule, moduleStartTime, currentModuleQuestions, selectedAnswers, moduleResults, currentModuleIndex, fetchQuestions, recordQuestionTime, questionTimeSpent])\r\n\r\n  const completeTest = useCallback((finalModuleResults: QuestionResult[][]) => {\r\n    if (!testStartTime) return\r\n\r\n    const endTime = new Date()\r\n    const totalTimeSpent = Math.floor((endTime.getTime() - testStartTime.getTime()) / 1000)\r\n    \r\n    // Calculate overall results\r\n    const allResults = finalModuleResults.flat()\r\n    const correctAnswers = allResults.filter(r => r.isCorrect).length\r\n    const totalQuestions = allResults.length\r\n    \r\n    // Calculate category performance\r\n    const categoryPerformance: Record<string, { correct: number; total: number }> = {}\r\n    allResults.forEach(result => {\r\n      if (!categoryPerformance[result.category]) {\r\n        categoryPerformance[result.category] = { correct: 0, total: 0 }\r\n      }\r\n      categoryPerformance[result.category].total++\r\n      if (result.isCorrect) {\r\n        categoryPerformance[result.category].correct++\r\n      }\r\n    })\r\n\r\n    const finalResults: TestResult = {\r\n      id: `test-${Date.now()}`,\r\n      userId,\r\n      startTime: testStartTime,\r\n      endTime,\r\n      totalTimeSpent,\r\n      totalQuestions,\r\n      correctAnswers,\r\n      score: Math.round((correctAnswers / totalQuestions) * 100),\r\n      moduleResults: finalModuleResults,\r\n      categoryPerformance,\r\n      completedAt: endTime\r\n    }\r\n\r\n    setTestResults(finalResults)\r\n    setIsComplete(true)\r\n  }, [testStartTime, userId])\r\n\r\n  // Timer countdown effect\r\n  useEffect(() => {\r\n    if (moduleStarted && timeRemaining > 0 && !isTransitioning && !isComplete) {\r\n      const timer = setTimeout(() => {\r\n        setTimeRemaining(prev => prev - 1)\r\n      }, 1000)\r\n\r\n      return () => clearTimeout(timer)\r\n    } else if (moduleStarted && timeRemaining === 0) {\r\n      // Time's up for this module\r\n      completeModule()\r\n    }\r\n  }, [moduleStarted, timeRemaining, isTransitioning, isComplete, completeModule])\r\n\r\n  const selectAnswer = useCallback((answerIndex: number) => {\r\n    if (currentQuestionIndex >= 0 && currentQuestionIndex < selectedAnswers.length) {\r\n      const newAnswers = [...selectedAnswers]\r\n      newAnswers[currentQuestionIndex] = answerIndex\r\n      setSelectedAnswers(newAnswers)\r\n    }\r\n  }, [currentQuestionIndex, selectedAnswers])\r\n\r\n  const nextQuestion = useCallback(() => {\r\n    if (currentQuestionIndex < currentModuleQuestions.length - 1) {\r\n      recordQuestionTime()\r\n      setCurrentQuestionIndex(prev => prev + 1)\r\n    }\r\n  }, [currentQuestionIndex, currentModuleQuestions.length, recordQuestionTime])\r\n\r\n  const previousQuestion = useCallback(() => {\r\n    if (currentQuestionIndex > 0) {\r\n      recordQuestionTime()\r\n      setCurrentQuestionIndex(prev => prev - 1)\r\n    }\r\n  }, [currentQuestionIndex, recordQuestionTime])\r\n\r\n  const goToQuestion = useCallback((questionIndex: number) => {\r\n    if (questionIndex >= 0 && questionIndex < currentModuleQuestions.length) {\r\n      recordQuestionTime()\r\n      setCurrentQuestionIndex(questionIndex)\r\n    }\r\n  }, [currentModuleQuestions.length, recordQuestionTime])\r\n\r\n  return {\r\n    // State\r\n    testState,\r\n    isLoading,\r\n    error,\r\n    hasStarted,\r\n    currentModuleIndex,\r\n    currentQuestionIndex,\r\n    isTransitioning,\r\n    isComplete,\r\n    moduleStarted,\r\n    isBreakTime,\r\n    breakTimeRemaining,\r\n    timeRemaining,\r\n    selectedAnswers,\r\n    testResults,\r\n    currentModule,\r\n    currentQuestion,\r\n    currentModuleQuestions,\r\n    \r\n    // Actions\r\n    startTest,\r\n    startModule,\r\n    completeModule,\r\n    selectAnswer,\r\n    nextQuestion,\r\n    previousQuestion,\r\n    goToQuestion,\r\n    \r\n    // Computed values\r\n    progress: currentModuleQuestions.length > 0 ? \r\n      Math.round(((currentQuestionIndex + 1) / currentModuleQuestions.length) * 100) : 0,\r\n    questionsAnswered: selectedAnswers.filter(answer => answer !== -1).length,\r\n    canGoNext: currentQuestionIndex < currentModuleQuestions.length - 1,\r\n    canGoPrevious: currentQuestionIndex > 0,\r\n    selectedAnswer: selectedAnswers[currentQuestionIndex] ?? -1\r\n  }\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 490, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/lionv/DuckSAT/Migration/DuckSAT_CLEAN/src/components/MathRenderer.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport React from 'react'\r\nimport 'katex/dist/katex.min.css'\r\nimport { InlineMath, BlockMath } from 'react-katex'\r\n\r\ninterface MathRendererProps {\r\n  children: string\r\n  block?: boolean\r\n  className?: string\r\n}\r\n\r\n/**\r\n * MathRenderer component for displaying mathematical equations\r\n * Automatically detects and renders LaTeX math expressions\r\n */\r\nexport default function MathRenderer({ children, block = false, className = '' }: MathRendererProps) {\r\n  // Convert common math notation to LaTeX\r\n  const convertToLatex = (text: string): string => {\r\n    return text\r\n      // Fractions: 1/2 -> \\frac{1}{2}\r\n      .replace(/(\\d+)\\/(\\d+)/g, '\\\\frac{$1}{$2}')\r\n      // Exponents: x^2 -> x^{2}, x^(2+3) -> x^{(2+3)}\r\n      .replace(/\\^(\\d+)/g, '^{$1}')\r\n      .replace(/\\^(\\([^)]+\\))/g, '^{$1}')\r\n      // Square roots: sqrt(x) -> \\sqrt{x}\r\n      .replace(/sqrt\\(([^)]+)\\)/g, '\\\\sqrt{$1}')\r\n      // Subscripts: x_1 -> x_{1}\r\n      .replace(/_(\\d+)/g, '_{$1}')\r\n      // Greek letters\r\n      .replace(/\\bpi\\b/g, '\\\\pi')\r\n      .replace(/\\btheta\\b/g, '\\\\theta')\r\n      .replace(/\\balpha\\b/g, '\\\\alpha')\r\n      .replace(/\\bbeta\\b/g, '\\\\beta')\r\n      .replace(/\\bgamma\\b/g, '\\\\gamma')\r\n      .replace(/\\bdelta\\b/g, '\\\\delta')\r\n      // Infinity\r\n      .replace(/infinity/g, '\\\\infty')\r\n      // Plus/minus\r\n      .replace(/\\+\\/-/g, '\\\\pm')\r\n      // Degree symbol\r\n      .replace(/degrees?/g, '^\\\\circ')\r\n      // Inequalities\r\n      .replace(/<=/g, '\\\\leq')\r\n      .replace(/>=/g, '\\\\geq')\r\n      .replace(/!=/g, '\\\\neq')\r\n      // Functions\r\n      .replace(/\\bsin\\b/g, '\\\\sin')\r\n      .replace(/\\bcos\\b/g, '\\\\cos')\r\n      .replace(/\\btan\\b/g, '\\\\tan')\r\n      .replace(/\\blog\\b/g, '\\\\log')\r\n      .replace(/\\bln\\b/g, '\\\\ln')\r\n  }\r\n\r\n  // Check if the text contains math expressions\r\n  const containsMath = (text: string): boolean => {\r\n    const mathPatterns = [\r\n      /\\^[\\d\\{\\(]/,  // Exponents\r\n      /_[\\d\\{]/,     // Subscripts\r\n      /\\\\[a-zA-Z]+/, // LaTeX commands\r\n      /\\\\\\{|\\\\\\}/,   // LaTeX braces\r\n      /\\bsqrt\\(/,    // Square root\r\n      /\\d+\\/\\d+/,    // Fractions\r\n      /[xy]\\s*[=<>]/,// Equations\r\n      /\\([^)]*[xy][^)]*\\)/, // Expressions with variables\r\n    ]\r\n    return mathPatterns.some(pattern => pattern.test(text))\r\n  }\r\n\r\n  // Split text into math and non-math parts\r\n  const renderMixedContent = (text: string) => {\r\n    // Look for inline math expressions in $...$ or between common math patterns\r\n    const parts = []\r\n    let currentIndex = 0\r\n    \r\n    // Find math expressions\r\n    const mathRegex = /(\\$[^$]+\\$|[xy]\\s*=\\s*[^,\\s.!?]+|f\\([^)]+\\)\\s*=\\s*[^,\\s.!?]+|\\d+\\/\\d+|[a-zA-Z]\\^[\\d\\{]|\\\\[a-zA-Z]+\\{[^}]*\\})/g\r\n    let match\r\n    \r\n    while ((match = mathRegex.exec(text)) !== null) {\r\n      // Add text before math\r\n      if (match.index > currentIndex) {\r\n        parts.push(\r\n          <span key={`text-${currentIndex}`}>\r\n            {text.slice(currentIndex, match.index)}\r\n          </span>\r\n        )\r\n      }\r\n      \r\n      // Add math expression\r\n      let mathExpression = match[1]\r\n      if (mathExpression.startsWith('$') && mathExpression.endsWith('$')) {\r\n        mathExpression = mathExpression.slice(1, -1)\r\n      }\r\n      \r\n      try {\r\n        parts.push(\r\n          <InlineMath key={`math-${match.index}`}>\r\n            {convertToLatex(mathExpression)}\r\n          </InlineMath>\r\n        )\r\n      } catch (error) {\r\n        // If LaTeX parsing fails, show as regular text\r\n        parts.push(\r\n          <span key={`fallback-${match.index}`} className=\"font-mono bg-gray-100 px-1 rounded\">\r\n            {mathExpression}\r\n          </span>\r\n        )\r\n      }\r\n      \r\n      currentIndex = match.index + match[0].length\r\n    }\r\n    \r\n    // Add remaining text\r\n    if (currentIndex < text.length) {\r\n      parts.push(\r\n        <span key={`text-${currentIndex}`}>\r\n          {text.slice(currentIndex)}\r\n        </span>\r\n      )\r\n    }\r\n    \r\n    return parts.length > 0 ? parts : [text]\r\n  }\r\n\r\n  // If it's a block math expression or contains only math\r\n  if (block || (containsMath(children) && children.trim().match(/^[\\s\\$]*[xy]\\s*=|^[\\s\\$]*f\\([^)]+\\)\\s*=|^[\\s\\$]*\\\\[a-zA-Z]/))) {\r\n    try {\r\n      let mathExpression = children\r\n      if (mathExpression.startsWith('$') && mathExpression.endsWith('$')) {\r\n        mathExpression = mathExpression.slice(1, -1)\r\n      }\r\n      \r\n      return (\r\n        <div className={`math-block ${className}`}>\r\n          <BlockMath>{convertToLatex(mathExpression)}</BlockMath>\r\n        </div>\r\n      )\r\n    } catch (error) {\r\n      return (\r\n        <div className={`font-mono bg-gray-100 p-2 rounded ${className}`}>\r\n          {children}\r\n        </div>\r\n      )\r\n    }\r\n  }\r\n\r\n  // For mixed content (text with inline math)\r\n  if (containsMath(children)) {\r\n    return (\r\n      <span className={className}>\r\n        {renderMixedContent(children)}\r\n      </span>\r\n    )\r\n  }\r\n\r\n  // Regular text\r\n  return <span className={className}>{children}</span>\r\n}\r\n\r\n// Helper component for specifically rendering equations\r\nexport function MathEquation({ children, className = '' }: { children: string; className?: string }) {\r\n  return <MathRenderer block={true} className={className}>{children}</MathRenderer>\r\n}\r\n\r\n// Helper component for inline math\r\nexport function InlineMathRenderer({ children, className = '' }: { children: string; className?: string }) {\r\n  return <MathRenderer block={false} className={className}>{children}</MathRenderer>\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 678, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/lionv/DuckSAT/Migration/DuckSAT_CLEAN/src/components/ChartRenderer.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport React from 'react'\r\n\r\nimport { VegaEmbed } from 'react-vega';\r\n\r\n// Types\r\ntype ChartType = 'scatter' | 'coordinate-plane' | 'scatter-plot' | 'bar' | 'bar-chart' | 'geometry' | 'geometric-diagram' | 'image' | string\r\n\r\ninterface ChartDataCommon {\r\n  type?: string\r\n  graphType?: string\r\n  diagramType?: string\r\n  description?: string\r\n  imageUrl?: string\r\n}\r\n\r\ninterface ScatterPoint {\r\n  x: number\r\n  y: number\r\n  label?: string\r\n}\r\n\r\ninterface XYDatum {\r\n  x?: number\r\n  y?: number\r\n  label?: string\r\n  point?: string\r\n}\r\n\r\ninterface ScatterChartData extends ChartDataCommon {\r\n  points?: ScatterPoint[]\r\n  data?: XYDatum[]\r\n  line?: boolean\r\n}\r\n\r\ninterface BarItem {\r\n  label?: string\r\n  student?: string\r\n  value?: number\r\n  score?: number\r\n}\r\n\r\ninterface BarChartData extends ChartDataCommon {\r\n  data?: BarItem[]\r\n}\r\n\r\ninterface GeometryChartData extends ChartDataCommon {\r\n  shape?: string\r\n  angles?: number[]\r\n}\r\n\r\ninterface ImageDiagramData extends ChartDataCommon {\r\n  type?: 'image'\r\n}\r\n\r\ntype ChartData = ScatterChartData | BarChartData | GeometryChartData | ImageDiagramData\r\n\r\ninterface ChartRendererProps {\r\n  chartData: ChartData\r\n  imageUrl?: string\r\n  imageData?: string\r\n  imageMimeType?: string\r\n  imageAlt?: string\r\n  className?: string\r\n}\r\n\r\nconst resolveType = (cd: ChartData): string | undefined => cd.type || cd.graphType || cd.diagramType\r\n\r\nconst allowedTypes = ['scatter', 'coordinate-plane', 'scatter-plot', 'bar', 'bar-chart', 'geometry', 'geometric-diagram', 'image'];\r\n\r\nexport default function ChartRenderer({ chartData, imageUrl, imageData, imageMimeType, imageAlt = \"Question diagram\", className = \"\" }: ChartRendererProps) {\r\n  // Check if imageUrl is a Vega spec (starts with data:image/svg+xml;base64 and contains Vega schema)\r\n  const isVegaSpec = imageUrl?.startsWith('data:image/svg+xml;base64,');\r\n\r\n  if (isVegaSpec && imageUrl) {\r\n    // Decode the base64 Vega spec and render with DynamicChart\r\n    try {\r\n      const base64Data = imageUrl.split(',')[1];\r\n      const decodedSpec = atob(base64Data);\r\n      const vegaSpec = JSON.parse(decodedSpec);\r\n\r\n      // Use DynamicChart to render the Vega spec\r\n      return (\r\n        <div className={`chart-container ${className}`}>\r\n          <div className=\"bg-white p-4 rounded border shadow-sm\">\r\n            <div className=\"text-sm font-semibold text-gray-700 mb-2\">üìä Chart</div>\r\n            <div className=\"text-xs text-gray-600 mb-2\">\r\n              Vega-Lite diagram (interactive visualization)\r\n            </div>\r\n            {/* Render Vega-Lite diagram */}\r\n            <VegaEmbed\r\n              spec={vegaSpec as any}\r\n              options={{ actions: false }}\r\n            />\r\n          </div>\r\n        </div>\r\n      );\r\n    } catch (e) {\r\n      console.error('Failed to decode Vega spec:', e);\r\n      return (\r\n        <div className={`chart-container ${className}`}>\r\n          <div className=\"bg-gray-100 p-4 rounded text-center\">\r\n            <p className=\"text-sm text-red-600\">Failed to render diagram</p>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n\r\n  // Construct image source URL\r\n  let src: string | undefined;\r\n  if (imageData) {\r\n    // Use binary imageData if available\r\n    const mimeType = imageMimeType || 'image/png';\r\n    src = `data:${mimeType};base64,${imageData}`;\r\n  } else if (imageUrl) {\r\n    // Always use imageUrl if provided\r\n    src = imageUrl;\r\n  } else if (chartData && typeof chartData === 'object' && 'imageUrl' in chartData && (chartData as any).imageUrl) {\r\n    // Check chartData for imageUrl\r\n    src = (chartData as any).imageUrl;\r\n  } else {\r\n    // Fallback to placeholder if nothing else\r\n    src = '/assets/diagram-placeholder.svg';\r\n  }\r\n\r\n\r\n  if (src && !isVegaSpec) {\r\n    return (\r\n      <div className={`chart-container ${className}`}>\r\n        <img\r\n          src={src}\r\n          alt={imageAlt}\r\n          className=\"max-w-full h-auto rounded border shadow-sm\"\r\n          style={{ maxHeight: '400px' }}\r\n          onError={(e) => {\r\n            // If image fails to load, show placeholder\r\n            const img = e.target as HTMLImageElement;\r\n            img.src = '/assets/diagram-placeholder.svg';\r\n          }}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!chartData) {\r\n    return null;\r\n  }\r\n\r\n  // Check if chartData itself is a Vega-Lite spec\r\n  if (typeof chartData === 'object' && chartData && '$schema' in chartData) {\r\n    const vegaSpec = chartData as unknown as Record<string, unknown>;\r\n    if (typeof vegaSpec.$schema === 'string' && vegaSpec.$schema.includes('vega-lite')) {\r\n      return (\r\n        <div className={`chart-container ${className}`}>\r\n          <div className=\"bg-white p-4 rounded border shadow-sm\">\r\n            <VegaEmbed\r\n              spec={vegaSpec as any}\r\n              options={{ actions: false }}\r\n            />\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n\r\n  // Check if chartData has a nested vegaSpec property\r\n  if (typeof chartData === 'object' && chartData && 'vegaSpec' in chartData) {\r\n    const vegaSpec = (chartData as any).vegaSpec;\r\n    if (typeof vegaSpec === 'object' && vegaSpec) {\r\n      // Add $schema if missing (required for VegaLite component)\r\n      const completeSpec = {\r\n        $schema: 'https://vega.github.io/schema/vega-lite/v5.json',\r\n        ...vegaSpec\r\n      };\r\n\r\n      return (\r\n        <div className={`chart-container ${className}`}>\r\n          <div className=\"bg-white p-4 rounded border shadow-sm\">\r\n            <VegaEmbed\r\n              spec={completeSpec as any}\r\n              options={{ actions: false }}\r\n            />\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className={`chart-container ${className}`}>\r\n      <DynamicChart chartData={chartData} />\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\nfunction DynamicChart({ chartData }: { chartData: ChartData }) {\r\n  if (!chartData) {\r\n    return null\r\n  }\r\n\r\n  const type = resolveType(chartData)\r\n\r\n  if (isScatter(chartData)) {\r\n    let normalized: ScatterChartData = { ...chartData }\r\n    if (!normalized.points && Array.isArray(normalized.data)) {\r\n      const points: ScatterPoint[] = (normalized.data ?? [])\r\n        .filter((p): p is XYDatum & { x: number; y: number } => typeof p?.x === 'number' && typeof p?.y === 'number')\r\n        .map((p) => ({ x: p.x, y: p.y, label: p.label ?? p.point ?? '' }))\r\n      normalized = { ...normalized, points }\r\n    }\r\n    return <ScatterPlot data={normalized} />\r\n  }\r\n\r\n  if (isBar(chartData)) {\r\n    return <BarChart data={chartData} />\r\n  }\r\n\r\n  if (isGeometry(chartData)) {\r\n    return <GeometryDiagram data={chartData} />\r\n  }\r\n\r\n  return (\r\n    <div className=\"bg-blue-50 p-4 rounded border\">\r\n      <div className=\"text-sm font-semibold text-blue-700 mb-2\">üìä Chart</div>\r\n      {chartData.description && (\r\n        <div className=\"text-sm text-blue-600 mb-2\">{chartData.description}</div>\r\n      )}\r\n      <div className=\"text-xs text-gray-500\">\r\n        Type: {type || 'Unknown'}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nfunction isScatter(cd: ChartData): cd is ScatterChartData {\r\n  const t = resolveType(cd)\r\n  return t === 'scatter' || t === 'coordinate-plane' || t === 'scatter-plot' || !!(cd as ScatterChartData).points\r\n}\r\n\r\nfunction isBar(cd: ChartData): cd is BarChartData {\r\n  const t = resolveType(cd)\r\n  return t === 'bar' || t === 'bar-chart' || Array.isArray((cd as BarChartData).data)\r\n}\r\n\r\nfunction isGeometry(cd: ChartData): cd is GeometryChartData {\r\n  const t = resolveType(cd)\r\n  return t === 'geometry' || t === 'geometric-diagram' || !!(cd as GeometryChartData).shape\r\n}\r\n\r\nfunction ScatterPlot({ data }: { data: ScatterChartData }) {\r\n  const width = 300\r\n  const height = 300\r\n  const padding = 40\r\n\r\n  return (\r\n    <div className=\"bg-white p-4 rounded border shadow-sm\">\r\n      <div className=\"text-sm font-semibold text-gray-700 mb-2\">üìà Coordinate Plane</div>\r\n      <svg width={width} height={height} className=\"border border-gray-300\">\r\n        {/* Grid */}\r\n        <defs>\r\n          <pattern id=\"grid\" width=\"20\" height=\"20\" patternUnits=\"userSpaceOnUse\">\r\n            <path d=\"M 20 0 L 0 0 0 20\" fill=\"none\" stroke=\"#e5e7eb\" strokeWidth=\"0.5\" />\r\n          </pattern>\r\n        </defs>\r\n        <rect x={padding} y={padding} width={width - 2 * padding} height={height - 2 * padding} fill=\"url(#grid)\" />\r\n\r\n        {/* Axes */}\r\n        <line x1={padding} y1={height / 2} x2={width - padding} y2={height / 2} stroke=\"#374151\" strokeWidth=\"2\" />\r\n        <line x1={width / 2} y1={padding} x2={width / 2} y2={height - padding} stroke=\"#374151\" strokeWidth=\"2\" />\r\n\r\n        {/* Points */}\r\n        {data.points?.map((point, index) => {\r\n          const x = width / 2 + (point.x || 0) * 10\r\n          const y = height / 2 - (point.y || 0) * 10\r\n\r\n          return (\r\n            <g key={index}>\r\n              <circle\r\n                cx={x}\r\n                cy={y}\r\n                r=\"5\"\r\n                fill=\"#3b82f6\"\r\n                stroke=\"#1d4ed8\"\r\n                strokeWidth=\"2\"\r\n              />\r\n              {point.label && (\r\n                <text\r\n                  x={x + 8}\r\n                  y={y - 8}\r\n                  fontSize=\"12\"\r\n                  fill=\"#374151\"\r\n                  fontWeight=\"bold\"\r\n                >\r\n                  {point.label}\r\n                </text>\r\n              )}\r\n            </g>\r\n          )\r\n        })}\r\n\r\n        {/* Line between points */}\r\n        {data.line && data.points && data.points.length >= 2 && (\r\n          <line\r\n            x1={width / 2 + (data.points[0].x || 0) * 10}\r\n            y1={height / 2 - (data.points[0].y || 0) * 10}\r\n            x2={width / 2 + (data.points[1].x || 0) * 10}\r\n            y2={height / 2 - (data.points[1].y || 0) * 10}\r\n            stroke=\"#ef4444\"\r\n            strokeWidth=\"2\"\r\n            strokeDasharray=\"5,5\"\r\n          />\r\n        )}\r\n      </svg>\r\n    </div>\r\n  )\r\n}\r\n\r\nfunction BarChart({ data }: { data: BarChartData }) {\r\n  const width = 300\r\n  const height = 200\r\n  const padding = 40\r\n\r\n  const values = data.data ?? []\r\n\r\n  // If no data, create sample data to prevent \"No data available\"\r\n  if (values.length === 0) {\r\n    console.log('‚ö†Ô∏è Bar chart has no data, creating sample data')\r\n    const sampleData: BarItem[] = [\r\n      { label: \"Jan\", value: 150 },\r\n      { label: \"Feb\", value: 200 },\r\n      { label: \"Mar\", value: 175 },\r\n      { label: \"Apr\", value: 225 }\r\n    ]\r\n    return <BarChart data={{ ...data, data: sampleData }} />\r\n  }\r\n\r\n  const maxValue = Math.max(...values.map((item) => item.score ?? item.value ?? 1))\r\n  const barWidth = Math.max(20, (width - 2 * padding) / values.length - 10)\r\n\r\n  return (\r\n    <div className=\"bg-white p-4 rounded border shadow-sm\">\r\n      <div className=\"text-sm font-semibold text-gray-700 mb-2\">üìä Bar Chart</div>\r\n      <svg width={width} height={height} className=\"border border-gray-300\">\r\n        {values.map((item, index) => {\r\n          const value = item.score ?? item.value ?? 0\r\n          const barHeight = Math.max(0, (value / maxValue) * (height - 2 * padding))\r\n          const x = padding + index * (barWidth + 10)\r\n          const y = height - padding - barHeight\r\n\r\n          return (\r\n            <g key={index}>\r\n              <rect\r\n                x={x}\r\n                y={y}\r\n                width={barWidth}\r\n                height={barHeight}\r\n                fill=\"#3b82f6\"\r\n                stroke=\"#1d4ed8\"\r\n              />\r\n              <text\r\n                x={x + barWidth / 2}\r\n                y={y - 5}\r\n                fontSize=\"10\"\r\n                fill=\"#374151\"\r\n                textAnchor=\"middle\"\r\n              >\r\n                {value}\r\n              </text>\r\n              <text\r\n                x={x + barWidth / 2}\r\n                y={height - padding + 15}\r\n                fontSize=\"10\"\r\n                fill=\"#374151\"\r\n                textAnchor=\"middle\"\r\n              >\r\n                {item.student ?? item.label ?? `${index + 1}`}\r\n              </text>\r\n            </g>\r\n          )\r\n        })}\r\n\r\n        {/* Axes */}\r\n        <line x1={padding} y1={height - padding} x2={width - padding} y2={height - padding} stroke=\"#374151\" strokeWidth=\"1\" />\r\n        <line x1={padding} y1={padding} x2={padding} y2={height - padding} stroke=\"#374151\" strokeWidth=\"1\" />\r\n      </svg>\r\n    </div>\r\n  )\r\n}\r\n\r\nfunction GeometryDiagram({ data }: { data: GeometryChartData }) {\r\n  const width = 400\r\n  const height = 350\r\n  const centerX = width / 2\r\n  const centerY = height / 2\r\n\r\n  return (\r\n    <div className=\"bg-white p-4 rounded border shadow-sm\">\r\n      <div className=\"text-sm font-semibold text-gray-700 mb-2\">üî∫ Geometry Diagram</div>\r\n      <svg width={width} height={height} className=\"border border-gray-200\">\r\n        {/* Always show a triangle by default for geometry questions */}\r\n        <TriangleShape data={data} centerX={centerX} centerY={centerY} />\r\n      </svg>\r\n    </div>\r\n  )\r\n}\r\n\r\nfunction TriangleShape({ data, centerX, centerY }: { data: GeometryChartData, centerX: number, centerY: number }) {\r\n  const size = 80\r\n  const triHeight = size * Math.sqrt(3) / 2\r\n\r\n  const points = [\r\n    [centerX, centerY - triHeight / 2],\r\n    [centerX - size / 2, centerY + triHeight / 2],\r\n    [centerX + size / 2, centerY + triHeight / 2]\r\n  ]\r\n\r\n  const pathData = `M ${points[0][0]} ${points[0][1]} L ${points[1][0]} ${points[1][1]} L ${points[2][0]} ${points[2][1]} Z`\r\n\r\n  // Use provided angles or default to 60¬∞ each for equilateral triangle\r\n  const angles = Array.isArray(data.angles) && data.angles.length >= 3 ? data.angles : [60, 60, 60]\r\n\r\n  return (\r\n    <g>\r\n      <path d={pathData} fill=\"rgba(59, 130, 246, 0.1)\" stroke=\"#3b82f6\" strokeWidth=\"2\" />\r\n\r\n      {/* Always show angle labels */}\r\n      <text x={centerX} y={centerY - triHeight / 2 + 15} fontSize=\"12\" fill=\"#374151\" textAnchor=\"middle\">\r\n        {angles[0]}¬∞\r\n      </text>\r\n      <text x={centerX - size / 2 + 15} y={centerY + triHeight / 2 - 5} fontSize=\"12\" fill=\"#374151\" textAnchor=\"middle\">\r\n        {angles[1]}¬∞\r\n      </text>\r\n      <text x={centerX + size / 2 - 15} y={centerY + triHeight / 2 - 5} fontSize=\"12\" fill=\"#374151\" textAnchor=\"middle\">\r\n        {angles[2]}¬∞\r\n      </text>\r\n\r\n      {/* Vertex labels */}\r\n      <text x={centerX} y={centerY - triHeight / 2 - 10} fontSize=\"12\" fill=\"#374151\" textAnchor=\"middle\" fontWeight=\"bold\">A</text>\r\n      <text x={centerX - size / 2 - 15} y={centerY + triHeight / 2 + 15} fontSize=\"12\" fill=\"#374151\" textAnchor=\"middle\" fontWeight=\"bold\">B</text>\r\n      <text x={centerX + size / 2 + 15} y={centerY + triHeight / 2 + 15} fontSize=\"12\" fill=\"#374151\" textAnchor=\"middle\" fontWeight=\"bold\">C</text>\r\n    </g>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1459, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/lionv/DuckSAT/Migration/DuckSAT_CLEAN/src/app/practice-test/page.tsx"],"sourcesContent":["\"use client\";\r\nimport React, { useEffect, useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { useSession } from 'next-auth/react';\r\nimport useTestState from '../../hooks/useTestState';\r\nimport TestLauncher from '../../components/TestLauncher';\r\nimport ModuleStart from '../../components/ModuleStart';\r\nimport TestAnalytics from '../../components/TestAnalytics';\r\nimport ReviewPage from '../../components/ReviewPage';\r\nimport QuestionNavigator from '../../components/QuestionNavigator';\r\nimport MathRenderer from '../../components/MathRenderer';\r\nimport ChartRenderer from '../../components/ChartRenderer';\r\n\r\nexport default function PracticeTestPage() {\r\n  const router = useRouter();\r\n  const { data: session } = useSession ? useSession() : { data: null };\r\n  const {\r\n    hasStarted,\r\n    moduleStarted,\r\n    currentModule,\r\n    currentQuestion,\r\n    currentQuestionIndex,\r\n    currentModuleQuestions,\r\n    completeModule,\r\n    selectedAnswers,\r\n    selectedAnswer,\r\n    startTest,\r\n    startModule,\r\n    isTransitioning,\r\n    isComplete,\r\n    testResults,\r\n    isBreakTime,\r\n    breakTimeRemaining,\r\n    goToQuestion,\r\n    setShowReview,\r\n    showReview,\r\n    timeRemaining,\r\n    selectAnswer,\r\n    nextQuestion,\r\n    previousQuestion,\r\n    questionsAnswered\r\n  } = useTestState(session?.user?.email || '');\r\n\r\n  const submitModule = completeModule;\r\n  const currentSelectedAnswer = selectedAnswer;\r\n\r\n  // Track answered questions for navigator\r\n  const answeredQuestions = selectedAnswers\r\n    ? selectedAnswers.map((answer, index) => answer !== -1 ? index : -1).filter(index => index !== -1)\r\n    : [];\r\n\r\n  // Error state for loading and submission\r\n  const [fetchError, setFetchError] = useState<string | null>(null);\r\n  const [submitError, setSubmitError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (typeof window !== 'undefined' && !session) {\r\n      router.push('/');\r\n    }\r\n  }, [session, router]);\r\n\r\n  // Debug logging\r\n  useEffect(() => {\r\n    console.log('Test State Debug:', {\r\n      hasStarted,\r\n      moduleStarted,\r\n      currentModule: currentModule?.id,\r\n      currentQuestion: currentQuestion?.id,\r\n      currentQuestionPassage: currentQuestion?.passage,\r\n      isTransitioning,\r\n      isComplete\r\n    });\r\n  }, [hasStarted, moduleStarted, currentModule, currentQuestion, isTransitioning, isComplete]);\r\n\r\n  if (!session) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"flex space-x-2\">\r\n          <div className=\"w-4 h-4 bg-blue-600 rounded-full animate-bounce\"></div>\r\n          <div className=\"w-4 h-4 bg-purple-600 rounded-full animate-bounce delay-100\"></div>\r\n          <div className=\"w-4 h-4 bg-pink-600 rounded-full animate-bounce delay-200\"></div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Test launcher screen\r\n  if (!hasStarted) {\r\n    return <TestLauncher onStartTest={startTest} />;\r\n  }\r\n\r\n  // Break time screen\r\n  if (isBreakTime) {\r\n    const minutes = Math.floor(breakTimeRemaining / 60);\r\n    const seconds = breakTimeRemaining % 60;\r\n    return (\r\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 flex items-center justify-center\">\r\n        <div className=\"bg-white rounded-2xl shadow-2xl p-12 text-center max-w-md\">\r\n          <div className=\"text-6xl mb-6\">‚òï</div>\r\n          <h2 className=\"text-3xl font-bold text-gray-900 mb-4\">Break Time</h2>\r\n\r\n          <p className=\"text-gray-600 mb-6\">\r\n            Take a 10-minute break before starting the Math section\r\n          </p>\r\n          <div className=\"text-4xl font-bold text-blue-600 mb-4\">\r\n            {minutes}:{seconds.toString().padStart(2, '0')}\r\n          </div>\r\n          <p className=\"text-sm text-gray-500\">\r\n            The Math section will start automatically when the break ends\r\n          </p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Module start screen (before starting each module)\r\n  if (currentModule && hasStarted && !moduleStarted && !isTransitioning) {\r\n    return (\r\n      <ModuleStart\r\n        module={currentModule}\r\n        onStartModule={startModule}\r\n      />\r\n    );\r\n  }\r\n\r\n  // Final results screen with analytics\r\n  if (isComplete && testResults) {\r\n    return <TestAnalytics testResults={testResults} />;\r\n  }\r\n\r\n  // Fallback completion screen (if no results)\r\n  if (isComplete) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 flex items-center justify-center\">\r\n        <div className=\"bg-white rounded-3xl shadow-2xl p-12 text-center max-w-2xl\">\r\n          <div className=\"text-6xl mb-6\">üéâ</div>\r\n          <h1 className=\"text-4xl font-bold text-gray-900 mb-4\">Test Complete!</h1>\r\n          <p className=\"text-xl text-gray-600 mb-8\">\r\n            Congratulations on completing your SAT practice test!\r\n          </p>\r\n          <button\r\n            onClick={() => router.push('/practice-test')}\r\n            className=\"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-4 rounded-2xl font-bold text-lg hover:shadow-lg transition-all\"\r\n          >\r\n            Take Another Test\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Main test interface\r\n  if (currentModule && currentQuestion && hasStarted && moduleStarted && !isTransitioning && !isComplete) {\r\n    // Show review page if user clicked review\r\n    if (showReview) {\r\n      return (\r\n        <ReviewPage\r\n          questions={currentModuleQuestions}\r\n          selectedAnswers={selectedAnswers}\r\n          currentModule={currentModule}\r\n          onQuestionClick={(index) => {\r\n            goToQuestion(index);\r\n            setShowReview(false);\r\n          }}\r\n          onSubmit={() => {\r\n            setShowReview(false);\r\n            submitModule();\r\n          }}\r\n          onBackToTest={() => setShowReview(false)}\r\n          timeRemaining={timeRemaining}\r\n        />\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div className=\"min-h-screen bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50\">\r\n        <div className=\"p-4 flex justify-between items-center\">\r\n          <button\r\n            onClick={() => router.push('/')}\r\n            className=\"bg-gray-200 text-gray-700 px-4 py-2 rounded-lg font-semibold hover:bg-gray-300 transition-all\"\r\n          >\r\n            ‚Üê Back to Home\r\n          </button>\r\n        </div>\r\n        {/* Question Navigator */}\r\n        <QuestionNavigator\r\n          totalQuestions={currentModule.questionCount}\r\n          currentQuestion={currentQuestionIndex}\r\n          answeredQuestions={answeredQuestions}\r\n          onQuestionClick={goToQuestion}\r\n          onReviewClick={() => setShowReview(true)}\r\n        />\r\n\r\n        {/* Header */}\r\n        <div className=\"bg-white/80 backdrop-blur-xl shadow-lg border-b border-white/20\">\r\n          <div className=\"max-w-6xl mx-auto px-4 py-4\">\r\n            <div className=\"flex justify-between items-center\">\r\n              <div>\r\n                <h1 className=\"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent\">\r\n                  {currentModule.title}\r\n                </h1>\r\n                <p className=\"text-gray-600\">\r\n                  Question {currentQuestionIndex + 1} of {currentModule.questionCount}\r\n                </p>\r\n              </div>\r\n              <div className=\"text-right\">\r\n                <div className={`text-2xl font-bold transition-colors ${\r\n                  timeRemaining <= 300 // 5 minutes\r\n                    ? 'text-red-500 animate-pulse'\r\n                    : timeRemaining <= 600 // 10 minutes\r\n                    ? 'text-orange-500'\r\n                    : 'text-purple-600'\r\n                }`}>\r\n                  {Math.floor(timeRemaining / 60)}:{(timeRemaining % 60).toString().padStart(2, '0')}\r\n                </div>\r\n                <div className=\"text-sm text-gray-500\">\r\n                  {timeRemaining <= 300 ? '‚ö†Ô∏è Time Running Out!' : 'Time Remaining'}\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Progress Bar */}\r\n            <div className=\"mt-4\">\r\n              <div className=\"w-full bg-gray-200 rounded-full h-2\">\r\n                <div\r\n                  className=\"bg-gradient-to-r from-blue-500 to-purple-600 h-2 rounded-full transition-all duration-300\"\r\n                  style={{ width: `${((currentQuestionIndex + 1) / currentModule.questionCount) * 100}%` }}\r\n                ></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"max-w-4xl mx-auto px-2 sm:px-4 py-4 sm:py-8 w-full\">\r\n          <div className=\"bg-white/80 backdrop-blur-xl rounded-3xl shadow-xl p-2 sm:p-8 border border-white/20 w-full\">\r\n            <div className=\"mb-8\">\r\n              {/* Always show passage first if it exists */}\r\n              {currentQuestion.passage && (\r\n                <div className=\"mb-8 p-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl border-2 border-blue-200 shadow-sm\">\r\n                  <div className=\"flex items-center mb-4\">\r\n                    <span className=\"bg-blue-500 text-white px-3 py-1 rounded-full text-sm font-semibold mr-3\">\r\n                      üìñ Reading Passage\r\n                    </span>\r\n                    <span className=\"text-blue-700 text-sm font-medium\">\r\n                      Read carefully before answering\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"prose prose-lg max-w-none\">\r\n                    <div className=\"text-gray-800 leading-relaxed font-medium bg-white p-4 rounded-lg border border-blue-100\">\r\n                      <MathRenderer>{currentQuestion.passage}</MathRenderer>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Chart/Diagram */}\r\n              {(currentQuestion.chartData || currentQuestion.imageUrl) && (\r\n                <div className=\"mb-6\">\r\n                  <ChartRenderer\r\n                    chartData={currentQuestion.chartData}\r\n                    imageUrl={currentQuestion.imageUrl}\r\n                    imageAlt={currentQuestion.imageAlt || 'Question diagram'}\r\n                  />\r\n                </div>\r\n              )}\r\n\r\n              <h3 className=\"text-xl font-semibold mb-6 text-gray-900\">\r\n                <MathRenderer>{currentQuestion.question}</MathRenderer>\r\n              </h3>\r\n\r\n              <div className=\"space-y-3\">\r\n                {currentQuestion.options.map((option, index) => {\r\n                  const isSelected = currentSelectedAnswer === index;\r\n                  return (\r\n                    <button\r\n                      key={index}\r\n                      onClick={() => selectAnswer(index)}\r\n                      className={`w-full text-left p-4 rounded-2xl border-2 transition-all duration-200 group focus:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 ${\r\n                        isSelected\r\n                          ? 'border-purple-500 bg-purple-100 shadow-md'\r\n                          : 'border-gray-200 hover:border-purple-300 hover:bg-purple-50'\r\n                      }`}\r\n                      aria-pressed={isSelected}\r\n                    >\r\n                      <div className=\"flex items-center\">\r\n                        <span className={`font-semibold mr-3 w-8 h-8 rounded-full flex items-center justify-center text-sm ${\r\n                          isSelected\r\n                            ? 'bg-purple-500 text-white'\r\n                            : 'bg-gray-200 text-gray-600 group-hover:bg-purple-200 group-hover:text-purple-700'\r\n                        }`}>\r\n                          {String.fromCharCode(65 + index)}\r\n                        </span>\r\n                        <span className={`${isSelected ? 'text-purple-900 font-medium' : 'text-gray-700'}`}>\r\n                          <MathRenderer>{option}</MathRenderer>\r\n                        </span>\r\n                      </div>\r\n                    </button>\r\n                  );\r\n                })}\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex flex-col sm:flex-row justify-between items-center gap-2 sm:gap-4 w-full\">\r\n              <button\r\n                onClick={previousQuestion}\r\n                disabled={currentQuestionIndex === 0}\r\n                className=\"px-6 py-3 bg-gray-200 text-gray-700 rounded-2xl disabled:opacity-50 hover:bg-gray-300 transition-colors font-medium\"\r\n              >\r\n                ‚Üê Previous\r\n              </button>\r\n\r\n              <div className=\"text-sm text-gray-500 text-center\">\r\n                <div>{currentQuestionIndex + 1} / {currentModule.questionCount}</div>\r\n                <div className=\"text-xs mt-1\">\r\n                  {questionsAnswered} answered\r\n                </div>\r\n              </div>\r\n\r\n              {currentQuestionIndex === currentModule.questionCount - 1 ? (\r\n                <button\r\n                  onClick={() => setShowReview(true)}\r\n                  className=\"px-6 py-3 bg-gradient-to-r from-amber-500 to-orange-600 text-white rounded-2xl hover:shadow-lg transition-all font-medium\"\r\n                >\r\n                  Review & Submit ‚Üí\r\n                </button>\r\n              ) : (\r\n                <button\r\n                  onClick={nextQuestion}\r\n                  className=\"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-2xl hover:shadow-lg transition-all font-medium\"\r\n                >\r\n                  Next ‚Üí\r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Loading and error state\r\n  return (\r\n    <div className=\"min-h-screen flex flex-col items-center justify-center\">\r\n      <div className=\"flex space-x-2 mb-6\" role=\"status\" aria-live=\"polite\" aria-label=\"Loading\">\r\n        <div className=\"w-4 h-4 bg-blue-600 rounded-full animate-bounce\" aria-hidden=\"true\"></div>\r\n        <div className=\"w-4 h-4 bg-purple-600 rounded-full animate-bounce delay-100\" aria-hidden=\"true\"></div>\r\n        <div className=\"w-4 h-4 bg-pink-600 rounded-full animate-bounce delay-200\" aria-hidden=\"true\"></div>\r\n      </div>\r\n      {fetchError && (\r\n        <div className=\"bg-red-100 border border-red-300 text-red-700 px-6 py-4 rounded-xl text-center max-w-md w-full mb-2\" role=\"alert\">\r\n          {fetchError}\r\n          <button\r\n            onClick={() => { setFetchError(null); /* re-trigger fetch/init here */ }}\r\n            className=\"ml-4 underline text-indigo-700 font-semibold hover:text-indigo-900\"\r\n          >\r\n            Retry\r\n          </button>\r\n        </div>\r\n      )}\r\n      {submitError && (\r\n        <div className=\"bg-red-100 border border-red-300 text-red-700 px-6 py-4 rounded-xl text-center max-w-md w-full mb-2\" role=\"alert\">\r\n          {submitError}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}