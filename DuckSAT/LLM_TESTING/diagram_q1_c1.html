<!DOCTYPE html>
<html>
<head>
<title>Vega Diagram</title>
<script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
</head>
<body>
<div id="vis"></div>
<script>
const spec = {"$schema": "https://vega.github.io/schema/vega/v5.json", "width": 600, "height": 400, "background": "white", "signals": [{"name": "cx", "value": 240}, {"name": "cy", "value": 220}, {"name": "r", "value": 100}, {"name": "Tx", "value": 520}, {"name": "Ty", "value": 180}, {"name": "dx", "update": "Tx - cx"}, {"name": "dy", "update": "Ty - cy"}, {"name": "sq", "update": "dx*dx + dy*dy"}, {"name": "k", "update": "(r*r)/sq"}, {"name": "m", "update": "r*sqrt(max(0, sq - r*r))/sq"}, {"name": "Ax", "update": "cx + k*dx - m*(-dy)"}, {"name": "Ay", "update": "cy + k*dy - m*(dx)"}, {"name": "v0x", "value": -1}, {"name": "v0y", "value": 0.2}, {"name": "vn", "update": "sqrt(v0x*v0x + v0y*v0y)"}, {"name": "ux", "update": "v0x/vn"}, {"name": "uy", "update": "v0y/vn"}, {"name": "wDot", "update": "(Tx - cx)*ux + (Ty - cy)*uy"}, {"name": "w2", "update": "(Tx - cx)*(Tx - cx) + (Ty - cy)*(Ty - cy)"}, {"name": "disc", "update": "wDot*wDot - (w2 - r*r)"}, {"name": "sqrtD", "update": "sqrt(max(0, disc))"}, {"name": "tB", "update": "(-wDot) - sqrtD"}, {"name": "tC", "update": "(-wDot) + sqrtD"}, {"name": "Bx", "update": "Tx + ux * tB"}, {"name": "By", "update": "Ty + uy * tB"}, {"name": "Cx", "update": "Tx + ux * tC"}, {"name": "Cy", "update": "Ty + uy * tC"}, {"name": "secScale", "value": 1200}, {"name": "Lx1", "update": "Tx - ux*secScale"}, {"name": "Ly1", "update": "Ty - uy*secScale"}, {"name": "Lx2", "update": "Tx + ux*secScale"}, {"name": "Ly2", "update": "Ty + uy*secScale"}, {"name": "s", "value": 10}, {"name": "u1x", "update": "(cx - Ax)/r"}, {"name": "u1y", "update": "(cy - Ay)/r"}, {"name": "v2x", "update": "Tx - Ax"}, {"name": "v2y", "update": "Ty - Ay"}, {"name": "v2n", "update": "sqrt(v2x*v2x + v2y*v2y)"}, {"name": "u2x", "update": "v2x / v2n"}, {"name": "u2y", "update": "v2y / v2n"}, {"name": "q1x", "update": "Ax + u1x * s"}, {"name": "q1y", "update": "Ay + u1y * s"}, {"name": "cornerx", "update": "q1x + u2x * s"}, {"name": "cornery", "update": "q1y + u2y * s"}, {"name": "q2x", "update": "Ax + u2x * s"}, {"name": "q2y", "update": "Ay + u2y * s"}, {"name": "rightAnglePath", "update": "'M ' + q1x + ' ' + q1y + ' L ' + cornerx + ' ' + cornery + ' L ' + q2x + ' ' + q2y"}, {"name": "mTAx", "update": "(Tx + Ax)/2"}, {"name": "mTAy", "update": "(Ty + Ay)/2"}, {"name": "vTAx", "update": "Ax - Tx"}, {"name": "vTAy", "update": "Ay - Ty"}, {"name": "nTAx", "update": "-vTAy"}, {"name": "nTAy", "update": "vTAx"}, {"name": "nTAn", "update": "sqrt(nTAx*nTAx + nTAy*nTAy)"}, {"name": "oTA", "value": 14}, {"name": "lTAx", "update": "mTAx + (nTAx / nTAn) * oTA"}, {"name": "lTAy", "update": "mTAy + (nTAy / nTAn) * oTA"}, {"name": "mTBx", "update": "(Tx + Bx)/2"}, {"name": "mTBy", "update": "(Ty + By)/2"}, {"name": "vTBx", "update": "Bx - Tx"}, {"name": "vTBy", "update": "By - Ty"}, {"name": "nTBx", "update": "-vTBy"}, {"name": "nTBy", "update": "vTBx"}, {"name": "nTBn", "update": "sqrt(nTBx*nTBx + nTBy*nTBy)"}, {"name": "oTB", "value": 14}, {"name": "lTBx", "update": "mTBx + (nTBx / nTBn) * oTB"}, {"name": "lTBy", "update": "mTBy + (nTBy / nTBn) * oTB"}], "marks": [{"type": "rule", "encode": {"enter": {"stroke": {"value": "#444"}, "strokeWidth": {"value": 2}}, "update": {"x": {"signal": "Lx1"}, "y": {"signal": "Ly1"}, "x2": {"signal": "Lx2"}, "y2": {"signal": "Ly2"}}}, "zindex": 0}, {"type": "arc", "encode": {"enter": {"x": {"signal": "cx"}, "y": {"signal": "cy"}, "innerRadius": {"signal": "r"}, "outerRadius": {"signal": "r"}, "startAngle": {"value": 0}, "endAngle": {"value": 6.283185307179586}, "stroke": {"value": "#000"}, "strokeWidth": {"value": 2}, "fill": {"value": "none"}}}, "zindex": 1}, {"type": "rule", "encode": {"enter": {"stroke": {"value": "#000"}, "strokeWidth": {"value": 2}}, "update": {"x": {"signal": "Tx"}, "y": {"signal": "Ty"}, "x2": {"signal": "Ax"}, "y2": {"signal": "Ay"}}}, "zindex": 2}, {"type": "rule", "encode": {"enter": {"stroke": {"value": "#666"}, "strokeDash": {"value": [4, 4]}, "strokeWidth": {"value": 1.5}}, "update": {"x": {"signal": "cx"}, "y": {"signal": "cy"}, "x2": {"signal": "Ax"}, "y2": {"signal": "Ay"}}}, "zindex": 2}, {"type": "path", "encode": {"enter": {"stroke": {"value": "#000"}, "strokeWidth": {"value": 1.5}}, "update": {"path": {"signal": "rightAnglePath"}}}, "zindex": 3}, {"type": "symbol", "encode": {"enter": {"size": {"value": 36}, "fill": {"value": "#000"}}, "update": {"x": {"signal": "cx"}, "y": {"signal": "cy"}}}, "zindex": 4}, {"type": "symbol", "encode": {"enter": {"size": {"value": 30}, "fill": {"value": "#000"}}, "update": {"x": {"signal": "Ax"}, "y": {"signal": "Ay"}}}, "zindex": 4}, {"type": "symbol", "encode": {"enter": {"size": {"value": 30}, "fill": {"value": "#000"}}, "update": {"x": {"signal": "Bx"}, "y": {"signal": "By"}}}, "zindex": 4}, {"type": "symbol", "encode": {"enter": {"size": {"value": 30}, "fill": {"value": "#000"}}, "update": {"x": {"signal": "Cx"}, "y": {"signal": "Cy"}}}, "zindex": 4}, {"type": "symbol", "encode": {"enter": {"size": {"value": 36}, "fill": {"value": "#000"}}, "update": {"x": {"signal": "Tx"}, "y": {"signal": "Ty"}}}, "zindex": 4}, {"type": "text", "encode": {"enter": {"text": {"value": "O"}, "fontSize": {"value": 14}, "align": {"value": "right"}, "baseline": {"value": "bottom"}}, "update": {"x": {"signal": "cx - 8"}, "y": {"signal": "cy - 8"}}}, "zindex": 5}, {"type": "text", "encode": {"enter": {"text": {"value": "A"}, "fontSize": {"value": 14}, "align": {"value": "left"}, "baseline": {"value": "bottom"}}, "update": {"x": {"signal": "Ax + 8"}, "y": {"signal": "Ay - 8"}}}, "zindex": 5}, {"type": "text", "encode": {"enter": {"text": {"value": "B"}, "fontSize": {"value": 14}, "align": {"value": "left"}, "baseline": {"value": "bottom"}}, "update": {"x": {"signal": "Bx + 8"}, "y": {"signal": "By - 8"}}}, "zindex": 5}, {"type": "text", "encode": {"enter": {"text": {"value": "C"}, "fontSize": {"value": 14}, "align": {"value": "right"}, "baseline": {"value": "top"}}, "update": {"x": {"signal": "Cx - 8"}, "y": {"signal": "Cy + 8"}}}, "zindex": 5}, {"type": "text", "encode": {"enter": {"text": {"value": "T"}, "fontSize": {"value": 14}, "align": {"value": "left"}, "baseline": {"value": "bottom"}}, "update": {"x": {"signal": "Tx + 8"}, "y": {"signal": "Ty - 8"}}}, "zindex": 5}, {"type": "text", "encode": {"enter": {"text": {"value": "12"}, "fontSize": {"value": 14}, "fill": {"value": "#000"}}, "update": {"x": {"signal": "lTAx"}, "y": {"signal": "lTAy"}}}, "zindex": 6}, {"type": "text", "encode": {"enter": {"text": {"value": "9"}, "fontSize": {"value": 14}, "fill": {"value": "#000"}}, "update": {"x": {"signal": "lTBx"}, "y": {"signal": "lTBy"}}}, "zindex": 6}]};
const view = new vega.View(vega.parse(spec)).renderer('canvas').initialize('#vis').run();
</script>
</body>
</html>